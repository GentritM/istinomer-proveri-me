{% extends "layout.html" %}

{% block style %}
    <style>
        .mainBox {
            width: 300px;
            height: 250px;
            background-color: #e7e7e8;
        }
        .selectOptions {
            width: 100%;
            float: left;
            background-color: #C4161C;
        }
        .classifications {
            margin: 2px;
            float: left;
            display: block;
        }
        .classiLabels{
           padding-left: 2px;
            color: #FFFFFF;
            font-weight: 500;
        }
        .stories {
            height: 45%;
            text-align: left;
            display:block;
        }
        .MyStories{
            overflow-y: scroll;
            width: 100%;
            height: 210px;
        }
        .evalMark, .spanGrade {
            height: 30%;
            font-size: smaller;
            text-decoration: none;
            width: 60px;
            border-radius: 5px;
            background-color: #337ab7;
            color: white;
        }
        .spanLink, .spanLink:hover, .spanLink:active {
            font-size: small;
            text-decoration: none;
            background-color: transparent;
            color: #C4191F;
        }
        .spanLink:hover {
            text-decoration: underline;
            text-underline: #C4191F;
        }
        .morelink {
            text-decoration:none !important;
            outline: none;
        }
        .morecontent span {
            display: none;
        }
         .morelink:active, .morelink:hover {
            text-decoration:none !important;
            outline: none;
        }
    </style>
{% endblock %}
{% block script %}
    <script>

    $(document).ready(function(){
        var show_max_char = 100;
        var ellipses_text = "...";
        var more_text = "[more]";
        var less_text = "[less]";

        $('.itemText').each(function() {
            var content = $(this).html();

            if(content.length > show_max_char) {

                var short_txt = content.substr(0, show_max_char);
                var full_txt = content.substr(show_max_char, content.length - show_max_char);

                var html = short_txt + '<span class="moreellipses">' + ellipses_text+ '</span><span class="morecontent"><span>' + full_txt + '</span><a href="" class="morelink">' + more_text + '</a></span>';

                $(this).html(html);
            }

        });
        $(".morelink").click(function(){
            if($(this).hasClass("less")) {
                $(this).removeClass("less");
                $(this).html(more_text);
            } else {
                $(this).addClass("less");
                $(this).html(less_text);
            }
            $(this).parent().prev().toggle();
            $(this).prev().toggle();
            return false;
        });
    });

{#        var classifications = [];#}
{#        $.getJSON(#}
{#            "http://0.0.0.0:5000/api/fact-check/classifications",#}
{#            {classifications: classifications},#}
{#            function(resp){#}
{#                alert(resp.toString());#}
{#            }#}
{#        );#}

    </script>
{% endblock %}
{% block content %}
<section class="container content-section text-center">
    <div class="row col-xs-offset-4">
        <div class="mainBox">
            <div class="selectOptions">
                <div class="classifications">
                    <input type="checkbox"  class="classificationsType" id="promise" checked/><label class="classiLabels" for="promise" >Promise</label>
                </div>
                <div class="classifications">
                    <input type="checkbox" class="classificationsType" id="truthfulness" checked/><label class="classiLabels" for="truthfulness" >Truthfulness</label>
                </div>
                <div class="classifications">
                    <input type="checkbox" class="classificationsType" id="consistency" checked/><label class="classiLabels" for="consistency" >Consistency</label>
                </div>
            </div>
            <hr>
            <div class="MyStories">
                {% for item in factcheck_requests %}
                    <div class="stories" style="padding: 2%">
                        <p class="itemText">{{ item.text }}</p>

                        <div style="display: inline-block;float: right">
                            <a class="spanLink" style="padding: 5px" href="{{ item.url }}" target="_blank">{{ item.domain }}<i class="fa fa-angle-double-right"></i></a>
                            <span class="evalMark" style="padding: 5px">{{ item.factChecked }}</span>
                            <span class="spanGrade" style="padding: 5px">{% if item.grade is defined %}{{ item.grade }}{% else %} N/A {% endif %}</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endblock %}